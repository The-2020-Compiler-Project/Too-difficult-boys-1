到目前为止，除目标代码生成外，基本完成所有组员的程序接口并成功运行。目标代码生成大家还在一起努力中。以下是我们的总体设计

| **编译阶段**     | **具体实现**                                                 |
| ---------------- | ------------------------------------------------------------ |
| 词法分析阶段     | Token序列；关键字表、界符表、符号表系统                      |
| 中间代码生成阶段 | 四元式序列（本组使用三地址码）；符号表系统                   |
| 编译器前端内容   | 词法、语法分析器（本组使用递归下降子程序）                   |
| 语义分析器       | 文法中插入语义动作，与语法分析一同进行                       |
| 语义分析         | 声明语句：获取标识符语义，填写符号表  操作语句：生成三地址码 |
| 编译器后端       | 简单优化去除无用变量、生成目标代码                           |

具体工作流程为

第一步：词法分析

读取文件中的源程序后开始扫描。根据初始化的关键字表、界符表对源程序串进行分词，并初步填写符号表。对于某些词法错误如标识符以数字开头等进行错误处理，对数字用常数处理机进行计算，得到其真实value。最终输出TOKEN序列，并保存在.token 文件中。

第二步：语法分析与语义分析

采用自顶向下的语法翻译制导技术，在原文法中插入语义动作来生成中间代码三地址码。语法分析部分同时收集语法错误，针对不同语句填写对应符号表。语义分析部分根据符号表进行类型检查等以收集语义错误，并根据不同语句查相应符号表生成三地址码。

第三步：简单优化

利用hash_map来标记变量的应用点、定义点等，对于始终不曾活跃的变量删除其四元式。循环此步骤直到四元式个数不在变化以尽可能的消除无用变量，为生成高效目标代码打好基础。

第四步：生成目标代码

考虑到int 类型占4个字节，所以选用win32汇编语言作为目标语言。对于定义、赋值、运算、条件及循环等不同语句进行翻译。三地址码非常接近汇编语言形式，翻译时主要注意栈的分配。

本人负责的模块为语法分析，语义分析（四元式生成），本采用三地址码形式，调用中间代码模块的程序在语义分析模块生成三地址码。

相比于上次工作，本人负责部分已经全部完成

对于语法分析，所有的子程序均设计完成，如数组、常熟、标识符、运算、=、《=、if、while、switch等，语义分析模块对上述语句的分析过程也都已完成、遇到的问题就是关于数组的四元式问题，学习查阅后这样解决：

实现数组元素的地址计算时，将产生两组四元式序列:
一组计算CONSPART,其值存放在临时变量T中;
另一组计算VARPART,其值存放在临时变量T1中;
用T [T1]（基址+变址）来表示数组元素的地址；

对数组元素的赋值和引用就有如下两种不同的四元式:
(1)变址存数:若有T[T1]=X,则可以用四元式
（[]=,X,_,T[T1]）表示
(2)变址取数:若有X=T[T1]， 则可用四元式

（=[],T[T1],_,X）表示

再将其转换为三地址码

